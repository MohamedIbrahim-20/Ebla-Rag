<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .layer-title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #34495e; }
      .component-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .component-text { font-family: Arial, sans-serif; font-size: 12px; fill: #34495e; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .api-text { font-family: Arial, sans-serif; font-size: 11px; fill: #e74c3c; }
      .data-flow { stroke: #3498db; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .api-flow { stroke: #e74c3c; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .db-flow { stroke: #9b59b6; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .external-flow { stroke: #f39c12; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="1000" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2"/>

  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="title">Ebla-RAG System Architecture</text>

  <!-- Frontend Layer -->
  <rect x="50" y="60" width="1300" height="120" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2" rx="10"/>
  <text x="70" y="85" class="layer-title">Frontend Layer</text>
  
  <!-- Web UI -->
  <rect x="100" y="100" width="200" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="200" y="120" text-anchor="middle" class="component-title" fill="white">Web UI</text>
  <text x="200" y="135" text-anchor="middle" class="component-text" fill="white">chat.html</text>
  <text x="200" y="150" text-anchor="middle" class="small-text" fill="white">Jinja2 Templates</text>

  <!-- JavaScript Client -->
  <rect x="350" y="100" width="200" height="60" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
  <text x="450" y="120" text-anchor="middle" class="component-title" fill="white">JavaScript Client</text>
  <text x="450" y="135" text-anchor="middle" class="component-text" fill="white">chat.js</text>
  <text x="450" y="150" text-anchor="middle" class="small-text" fill="white">Session Management</text>

  <!-- Static Assets -->
  <rect x="600" y="100" width="200" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="700" y="120" text-anchor="middle" class="component-title" fill="white">Static Assets</text>
  <text x="700" y="135" text-anchor="middle" class="component-text" fill="white">CSS/JS Files</text>
  <text x="700" y="150" text-anchor="middle" class="small-text" fill="white">styles.css</text>

  <!-- API Gateway Layer -->
  <rect x="50" y="200" width="1300" height="120" fill="#e8f5e8" stroke="#27ae60" stroke-width="2" rx="10"/>
  <text x="70" y="225" class="layer-title">API Gateway Layer</text>

  <!-- FastAPI Application -->
  <rect x="100" y="240" width="300" height="60" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="250" y="260" text-anchor="middle" class="component-title" fill="white">FastAPI Application</text>
  <text x="250" y="275" text-anchor="middle" class="component-text" fill="white">main.py</text>
  <text x="250" y="290" text-anchor="middle" class="small-text" fill="white">Uvicorn Server</text>

  <!-- API Routers -->
  <rect x="450" y="240" width="150" height="60" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="525" y="260" text-anchor="middle" class="component-title" fill="white">Base Router</text>
  <text x="525" y="275" text-anchor="middle" class="component-text" fill="white">base.py</text>
  <text x="525" y="290" text-anchor="middle" class="small-text" fill="white">/api/v1</text>

  <rect x="650" y="240" width="150" height="60" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="725" y="260" text-anchor="middle" class="component-title" fill="white">Data Router</text>
  <text x="725" y="275" text-anchor="middle" class="component-text" fill="white">data.py</text>
  <text x="725" y="290" text-anchor="middle" class="small-text" fill="white">/api/v1/data</text>

  <rect x="850" y="240" width="150" height="60" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="925" y="260" text-anchor="middle" class="component-title" fill="white">Chat Router</text>
  <text x="925" y="275" text-anchor="middle" class="component-text" fill="white">chat.py</text>
  <text x="925" y="290" text-anchor="middle" class="small-text" fill="white">/api/v1/chat</text>

  <!-- Configuration -->
  <rect x="1050" y="240" width="150" height="60" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2" rx="5"/>
  <text x="1125" y="260" text-anchor="middle" class="component-title" fill="white">Configuration</text>
  <text x="1125" y="275" text-anchor="middle" class="component-text" fill="white">config.py</text>
  <text x="1125" y="290" text-anchor="middle" class="small-text" fill="white">Settings</text>

  <!-- Business Logic Layer -->
  <rect x="50" y="340" width="1300" height="180" fill="#fef9e7" stroke="#f39c12" stroke-width="2" rx="10"/>
  <text x="70" y="365" class="layer-title">Business Logic Layer</text>

  <!-- Controllers -->
  <rect x="100" y="380" width="150" height="80" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="175" y="400" text-anchor="middle" class="component-title" fill="white">Base Controller</text>
  <text x="175" y="415" text-anchor="middle" class="component-text" fill="white">BaseController.py</text>
  <text x="175" y="430" text-anchor="middle" class="small-text" fill="white">Common Logic</text>
  <text x="175" y="445" text-anchor="middle" class="small-text" fill="white">File Management</text>

  <rect x="280" y="380" width="150" height="80" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="355" y="400" text-anchor="middle" class="component-title" fill="white">RAG Controller</text>
  <text x="355" y="415" text-anchor="middle" class="component-text" fill="white">GroqRAGController.py</text>
  <text x="355" y="430" text-anchor="middle" class="small-text" fill="white">LangChain</text>
  <text x="355" y="445" text-anchor="middle" class="small-text" fill="white">LlamaIndex</text>

  <rect x="460" y="380" width="150" height="80" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
  <text x="535" y="400" text-anchor="middle" class="component-title" fill="white">Data Controller</text>
  <text x="535" y="415" text-anchor="middle" class="component-text" fill="white">DataController.py</text>
  <text x="535" y="430" text-anchor="middle" class="small-text" fill="white">File Upload</text>
  <text x="535" y="445" text-anchor="middle" class="small-text" fill="white">Validation</text>

  <rect x="640" y="380" width="150" height="80" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="715" y="400" text-anchor="middle" class="component-title" fill="white">Project Controller</text>
  <text x="715" y="415" text-anchor="middle" class="component-text" fill="white">ProjectController.py</text>
  <text x="715" y="430" text-anchor="middle" class="small-text" fill="white">Project</text>
  <text x="715" y="445" text-anchor="middle" class="small-text" fill="white">Management</text>

  <rect x="820" y="380" width="150" height="80" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="895" y="400" text-anchor="middle" class="component-title" fill="white">Process Controller</text>
  <text x="895" y="415" text-anchor="middle" class="component-text" fill="white">ProcessController.py</text>
  <text x="895" y="430" text-anchor="middle" class="small-text" fill="white">Document</text>
  <text x="895" y="445" text-anchor="middle" class="small-text" fill="white">Processing</text>

  <!-- Helpers -->
  <rect x="1000" y="380" width="150" height="80" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2" rx="5"/>
  <text x="1075" y="400" text-anchor="middle" class="component-title" fill="white">Helpers</text>
  <text x="1075" y="415" text-anchor="middle" class="component-text" fill="white">prompts.py</text>
  <text x="1075" y="430" text-anchor="middle" class="small-text" fill="white">Prompt Building</text>
  <text x="1075" y="445" text-anchor="middle" class="small-text" fill="white">Templates</text>

  <!-- Data Layer -->
  <rect x="50" y="540" width="1300" height="180" fill="#f4f1fb" stroke="#9b59b6" stroke-width="2" rx="10"/>
  <text x="70" y="565" class="layer-title">Data Layer</text>

  <!-- Database -->
  <rect x="100" y="580" width="200" height="100" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="200" y="605" text-anchor="middle" class="component-title" fill="white">SQLite Database</text>
  <text x="200" y="620" text-anchor="middle" class="component-text" fill="white">chat_history.sqlite</text>
  <text x="200" y="635" text-anchor="middle" class="small-text" fill="white">Sessions</text>
  <text x="200" y="650" text-anchor="middle" class="small-text" fill="white">Messages</text>
  <text x="200" y="665" text-anchor="middle" class="small-text" fill="white">Retrievals</text>

  <!-- Vector Stores -->
  <rect x="350" y="580" width="200" height="100" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="450" y="605" text-anchor="middle" class="component-title" fill="white">FAISS Vector Store</text>
  <text x="450" y="620" text-anchor="middle" class="component-text" fill="white">LangChain Index</text>
  <text x="450" y="635" text-anchor="middle" class="small-text" fill="white">Document</text>
  <text x="450" y="650" text-anchor="middle" class="small-text" fill="white">Embeddings</text>
  <text x="450" y="665" text-anchor="middle" class="small-text" fill="white">Similarity Search</text>

  <rect x="600" y="580" width="200" height="100" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="700" y="605" text-anchor="middle" class="component-title" fill="white">LlamaIndex Store</text>
  <text x="700" y="620" text-anchor="middle" class="component-text" fill="white">Vector Index</text>
  <text x="700" y="635" text-anchor="middle" class="small-text" fill="white">Document</text>
  <text x="700" y="650" text-anchor="middle" class="small-text" fill="white">Storage</text>
  <text x="700" y="665" text-anchor="middle" class="small-text" fill="white">Query Engine</text>

  <!-- File Storage -->
  <rect x="850" y="580" width="200" height="100" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
  <text x="950" y="605" text-anchor="middle" class="component-title" fill="white">File Storage</text>
  <text x="950" y="620" text-anchor="middle" class="component-text" fill="white">assets/files</text>
  <text x="950" y="635" text-anchor="middle" class="small-text" fill="white">CSV Files</text>
  <text x="950" y="650" text-anchor="middle" class="small-text" fill="white">Uploaded Files</text>
  <text x="950" y="665" text-anchor="middle" class="small-text" fill="white">Project Data</text>

  <!-- External Services Layer -->
  <rect x="50" y="740" width="1300" height="120" fill="#fdf2e9" stroke="#e67e22" stroke-width="2" rx="10"/>
  <text x="70" y="765" class="layer-title">External Services Layer</text>

  <!-- Groq API -->
  <rect x="200" y="780" width="200" height="60" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="300" y="800" text-anchor="middle" class="component-title" fill="white">Groq API</text>
  <text x="300" y="815" text-anchor="middle" class="component-text" fill="white">LLM Service</text>
  <text x="300" y="830" text-anchor="middle" class="small-text" fill="white">llama-3.3-70b-versatile</text>

  <!-- HuggingFace -->
  <rect x="450" y="780" width="200" height="60" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="550" y="800" text-anchor="middle" class="component-title" fill="white">HuggingFace</text>
  <text x="550" y="815" text-anchor="middle" class="component-text" fill="white">Embeddings</text>
  <text x="550" y="830" text-anchor="middle" class="small-text" fill="white">sentence-transformers</text>

  <!-- API Endpoints -->
  <rect x="750" y="780" width="400" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="950" y="795" text-anchor="middle" class="component-title" fill="white">API Endpoints</text>
  <text x="800" y="810" text-anchor="start" class="api-text">POST /api/v1/chat</text>
  <text x="800" y="825" text-anchor="start" class="api-text">POST /api/v1/data/index/{project_id}</text>
  <text x="1000" y="810" text-anchor="start" class="api-text">POST /api/v1/data/search/{project_id}</text>
  <text x="1000" y="825" text-anchor="start" class="api-text">GET /api/v1/history/{session_id}</text>

  <!-- Data Flow Arrows -->
  <!-- Frontend to API -->
  <path d="M 450 160 L 450 200 L 250 200 L 250 240" class="api-flow"/>
  <text x="350" y="190" class="small-text">HTTP Requests</text>

  <!-- API to Controllers -->
  <path d="M 250 300 L 250 320 L 355 320 L 355 380" class="data-flow"/>
  <path d="M 725 300 L 725 320 L 535 320 L 535 380" class="data-flow"/>
  <path d="M 925 300 L 925 320 L 715 320 L 715 380" class="data-flow"/>

  <!-- Controllers to Data -->
  <path d="M 355 460 L 355 500 L 200 500 L 200 580" class="db-flow"/>
  <path d="M 355 460 L 355 520 L 450 520 L 450 580" class="data-flow"/>
  <path d="M 355 460 L 355 540 L 700 540 L 700 580" class="data-flow"/>
  <path d="M 535 460 L 535 500 L 950 500 L 950 580" class="data-flow"/>

  <!-- External Services -->
  <path d="M 355 460 L 355 720 L 300 720 L 300 780" class="external-flow"/>
  <path d="M 355 460 L 355 740 L 550 740 L 550 780" class="external-flow"/>

  <!-- Legend -->
  <rect x="1200" y="880" width="180" height="100" fill="white" stroke="#bdc3c7" stroke-width="1" rx="5"/>
  <text x="1210" y="900" class="component-title">Data Flow Legend</text>
  <line x1="1210" y1="910" x2="1240" y2="910" class="api-flow"/>
  <text x="1250" y="915" class="small-text">API Calls</text>
  <line x1="1210" y1="925" x2="1240" y2="925" class="data-flow"/>
  <text x="1250" y="930" class="small-text">Data Flow</text>
  <line x1="1210" y1="940" x2="1240" y2="940" class="db-flow"/>
  <text x="1250" y="945" class="small-text">Database</text>
  <line x1="1210" y1="955" x2="1240" y2="955" class="external-flow"/>
  <text x="1250" y="960" class="small-text">External APIs</text>

  <!-- System Features -->
  <rect x="50" y="880" width="300" height="100" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1" rx="5"/>
  <text x="60" y="900" class="component-title">Key Features</text>
  <text x="60" y="920" class="small-text">• Dual RAG Implementation (LangChain + LlamaIndex)</text>
  <text x="60" y="935" class="small-text">• Session-based Chat with History</text>
  <text x="60" y="950" class="small-text">• Automatic Conversation Summarization</text>
  <text x="60" y="965" class="small-text">• Vector-based Document Retrieval</text>

  <!-- Technology Stack -->
  <rect x="370" y="880" width="300" height="100" fill="#e8f5e8" stroke="#27ae60" stroke-width="1" rx="5"/>
  <text x="380" y="900" class="component-title">Technology Stack</text>
  <text x="380" y="920" class="small-text">• FastAPI + Uvicorn (Backend)</text>
  <text x="380" y="935" class="small-text">• SQLAlchemy + SQLite (Database)</text>
  <text x="380" y="950" class="small-text">• FAISS (Vector Search)</text>
  <text x="380" y="965" class="small-text">• Groq API (LLM)</text>

</svg>